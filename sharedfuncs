#!/bin/bash
# Shared functions between install and setup scripts

# prompt
# 1: message
# 2: color (green, yellow, blue, red)
prompt() {
    message="$1\033[0m\n"
    case $2 in
    green) message="\033[1;32m$message" ;;
    yellow) message="\033[1;33m$message" ;;
    red) message="\033[1;31m$message" ;;
    blue) message="\033[1;34m$message" ;;
    esac
    printf "$message"
}

# shellcheck disable=SC2154
# out handles running commands and redirecting the output
out() {
    # TODO add verbose and very verose option
    # TODO cleanup the things I don't know what they're doing
    local lines
    echo "COMMAND: $*" >>"$errorfile"
    # TODO I have no clue why I wrote this
    lines="$(wc -l "<$errorfile")"

    if [[ -n $logging ]]; then
        {
            echo "COMMAND: $*"
            "$@"
        } >>"$logFile" 2>&1
    else
        ("$verbose" && "$@" 2>>"$errorfile") || "$@" 1>/dev/null 2>>"$errorfile"
    fi

    # TODO I have no clue why I wrote this
    [ "$lines" == "$(wc -l <"$errorfile")" ] && sed -i '$ d' "$errorfile"
}

# shellcheck disable=SC2154
# log_variable logs the contents of a variable to the variableLog if the debug flag is set
# 1: name of variable
# 2: content
log_variable() {
    [[ -n $debug ]] &&
        printf "=-=-=-=-=-=-=-=-=-=-= %s =-=-=-=-=-=-=-=-=-=-=\n%s\n" "$1" "$2" >>"$variableLog"
}
